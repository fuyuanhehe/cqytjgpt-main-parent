<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org/DTD Mapper 3.0" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ccttic.mapper.logger.UserOperLoggerMapper">
    <!-- 所有的字段 -->
    <sql id="fieldAll">id, content, operType, operBy, operTime, ipAddr, remark</sql>

    <sql id="setFieldAll">#{id}, #{content}, #{operType}, #{operBy}, #{operTime}, #{ipAddr}, #{remark}</sql>

    <!-- 保存操作日志 -->
    <insert id="addUserOperLogger" parameterType="com.ccttic.entity.logger.UserOperLogger">
        INSERT INTO user_oper_log(<include refid="fieldAll"/>)
        VALUES (<include refid="setFieldAll"/>)
    </insert>

    <!-- 更新操作 -->
    <update id="renewUserOperLogger" parameterType="com.ccttic.entity.logger.UserOperLogger">
        UPDATE user_oper_log
        <set>
            <if test="content != null and content != ''">content = #{content},</if>
            <if test="operBy != null and operBy != ''">operBy = #{operBy},</if>
            <if test="operTime != null and operTime != ''">operTime = #{operTime},</if>
            <if test="ipAddr != null and ipAddr != ''">ipAddr = #{ipAddr},</if>
            <if test="remark != null and remark != ''">remark = #{remark},</if>
        </set>
        WHERE id = #{id}
    </update>

    <delete id="delUserOperLogger" parameterType="java.lang.String">
        DELETE FROM user_oper_log WHERE id = #{id}
    </delete>

    <!-- 说明：查找所有的logs -->
    <select id="findAllUserOperLogger" parameterType="java.util.Map" resultType="com.ccttic.entity.logger.UserOperLogger">
        SELECT <include refid="fieldAll"/> FROM user_oper_log
        <where>
            <if test="content != null and content != ''">content = #{content} </if>
            <if test="operBy != null and operBy != ''">AND operBy = #{operBy} </if>
            <if test="operType != null and operType != ''">AND operType = #{operType} </if>
            <if test="operTime != null and operTime != ''">AND operTime = #{operTime} </if>
            <if test="ipAddr != null and ipAddr != ''">AND ipAddr = #{ipAddr} </if>
            <if test="remark != null and remark != ''">AND remark = #{remark} </if>
        </where>
        ORDER BY operTime ASC
        <if test="startRecod != null">
            limit #{startRecod}, #{offset}
        </if>
    </select>

    <!-- 说明：查找所有的logs count -->
    <select id="findAllUserOperLoggerCount" parameterType="java.util.Map" resultType="java.lang.Integer">
        SELECT COUNT(id) FROM user_oper_log
        <where>
            <if test="content != null and content != ''">content = #{content} </if>
            <if test="operBy != null and operBy != ''">AND operBy = #{operBy} </if>
            <if test="operType != null and operType != ''">AND operType = #{operType} </if>
            <if test="operTime != null and operTime != ''">AND operTime = #{operTime} </if>
            <if test="ipAddr != null and ipAddr != ''">AND ipAddr = #{ipAddr} </if>
            <if test="remark != null and remark != ''">AND remark = #{remark} </if>
        </where>
    </select>
    
    <select id="findSingleUserOperLog" parameterType="java.lang.String" resultType="com.ccttic.entity.logger.UserOperLogger">
        SELECT <include refid="fieldAll"/> FROM user_oper_log WHERE id = #{id}
    </select>
</mapper>